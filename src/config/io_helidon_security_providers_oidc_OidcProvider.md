Open ID Connect security provider

Type:
[io.helidon.security.providers.oidc.OidcProvider](https://helidon.io/docs/v4/apidocs/io.helidon.security.providers.oidc/io/helidon/security/providers/oidc/OidcProvider.html)

Config key:
```text
oidc
```

This type provides the following service implementations:

- `io.helidon.security.spi.AuthenticationProvider`

- `io.helidon.security.spi.SecurityProvider`

# Configuration options

<table>
<caption>Optional configuration options</caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 23%" />
<col style="width: 15%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr>
<th>key</th>
<th>type</th>
<th>default value</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p><code>access-token-ip-check</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether to check if current IP address
matches the one access token was issued for. This check helps with
cookie replay attack prevention.</p></td>
</tr>
<tr>
<td><p><code>audience</code></p></td>
<td><p>string</p></td>
<td></td>
<td><p>Audience of issued tokens.</p></td>
</tr>
<tr>
<td><p><code>authorization-endpoint-uri</code></p></td>
<td><p>URI</p></td>
<td></td>
<td><p>URI of an authorization endpoint used
to redirect users to for logging-in.</p>
<p>If not defined, it is obtained from oidcMetadata(Resource), if that
is not defined an attempt is made to use
identityUri(URI)/oauth2/v1/authorize.</p></td>
</tr>
<tr>
<td><p><code>base-scopes</code></p></td>
<td><p>string</p></td>
<td><p><code>openid</code></p></td>
<td><p>Configure base scopes. By default, this
is DEFAULT_BASE_SCOPES. If scope has a qualifier, it must be used
here.</p></td>
</tr>
<tr>
<td><p><code>check-audience</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Configure audience claim
check.</p></td>
</tr>
<tr>
<td><p><code>client-credentials-config</code></p></td>
<td><p><a href="../config/io_helidon_security_providers_oidc_common_ClientCredentialsConfig.md">ClientCredentialsConfig</a></p></td>
<td></td>
<td><p>Set the configuration related to the
client credentials flow.</p></td>
</tr>
<tr>
<td><p><code>client-id</code></p></td>
<td><p>string</p></td>
<td></td>
<td><p>Client ID as generated by OIDC
server.</p></td>
</tr>
<tr>
<td><p><code>client-secret</code></p></td>
<td><p>string</p></td>
<td></td>
<td><p>Client secret as generated by OIDC
server. Used to authenticate this application with the server when
requesting JWT based on a code.</p></td>
</tr>
<tr>
<td><p><code>client-timeout-millis</code></p></td>
<td><p>Duration</p></td>
<td><p><code>30000</code></p></td>
<td><p>Timeout of calls using web
client.</p></td>
</tr>
<tr>
<td><p><code>cookie-domain</code></p></td>
<td><p>string</p></td>
<td></td>
<td><p>Domain the cookie is valid for. Not
used by default.</p></td>
</tr>
<tr>
<td><p><code>cookie-encryption-enabled</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>Whether to encrypt token cookie created
by this microservice. Defaults to <code>false</code>.</p></td>
</tr>
<tr>
<td><p><code>cookie-encryption-id-enabled</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether to encrypt id token cookie
created by this microservice. Defaults to <code>true</code>.</p></td>
</tr>
<tr>
<td><p><code>cookie-encryption-name</code></p></td>
<td><p>string</p></td>
<td></td>
<td><p>Name of the encryption configuration
available through Security.encrypt(String, byte[]) and
Security.decrypt(String, String). If configured and encryption is
enabled for any cookie, Security MUST be configured in global or current
<code>io.helidon.common.context.Context</code> (this is done
automatically in Helidon MP).</p></td>
</tr>
<tr>
<td><p><code>cookie-encryption-password</code></p></td>
<td><p>char[]</p></td>
<td></td>
<td><p>Master password for
encryption/decryption of cookies. This must be configured to the same
value on each microservice using the cookie.</p></td>
</tr>
<tr>
<td><p><code>cookie-encryption-refresh-enabled</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether to encrypt refresh token cookie
created by this microservice. Defaults to <code>true</code>.</p></td>
</tr>
<tr>
<td><p><code>cookie-encryption-state-enabled</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether to encrypt state cookie created
by this microservice. Defaults to <code>true</code>.</p></td>
</tr>
<tr>
<td><p><code>cookie-encryption-tenant-enabled</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether to encrypt tenant name cookie
created by this microservice. Defaults to <code>true</code>.</p></td>
</tr>
<tr>
<td><p><code>cookie-http-only</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>When using cookie, if set to true, the
HttpOnly attribute will be configured. Defaults to
OidcCookieHandler.Builder.DEFAULT_HTTP_ONLY.</p></td>
</tr>
<tr>
<td><p><code>cookie-max-age-seconds</code></p></td>
<td><p>long</p></td>
<td></td>
<td><p>When using cookie, used to set MaxAge
attribute of the cookie, defining how long the cookie is valid. Not used
by default.</p></td>
</tr>
<tr>
<td><p><code>cookie-name</code></p></td>
<td><p>string</p></td>
<td><p><code>JSESSIONID</code></p></td>
<td><p>Name of the cookie to use. Defaults to
DEFAULT_COOKIE_NAME.</p></td>
</tr>
<tr>
<td><p><code>cookie-name-id-token</code></p></td>
<td><p>string</p></td>
<td><p><code>JSESSIONID_2</code></p></td>
<td><p>Name of the cookie to use for id token.
Defaults to DEFAULT_COOKIE_NAME_2.</p>
<p>This cookie is only used when logout is enabled, as otherwise it is
not needed. Content of this cookie is encrypted.</p></td>
</tr>
<tr>
<td><p><code>cookie-name-refresh-token</code></p></td>
<td><p>string</p></td>
<td><p><code>JSESSIONID_3</code></p></td>
<td><p>The name of the cookie to use for the
refresh token. Defaults to DEFAULT_REFRESH_COOKIE_NAME.</p></td>
</tr>
<tr>
<td><p><code>cookie-name-state</code></p></td>
<td><p>string</p></td>
<td><p><code>JSESSIONID_3</code></p></td>
<td><p>The name of the cookie to use for the
state storage. Defaults to DEFAULT_STATE_COOKIE_NAME.</p></td>
</tr>
<tr>
<td><p><code>cookie-name-tenant</code></p></td>
<td><p>string</p></td>
<td><p><code>HELIDON_TENANT</code></p></td>
<td><p>The name of the cookie to use for the
tenant name. Defaults to DEFAULT_TENANT_COOKIE_NAME.</p></td>
</tr>
<tr>
<td><p><code>cookie-path</code></p></td>
<td><p>string</p></td>
<td><p><code>/</code></p></td>
<td><p>Path the cookie is valid for. Defaults
to "/".</p></td>
</tr>
<tr>
<td><p><code>cookie-same-site</code></p></td>
<td><p>SameSite (LAX, STRICT, NONE)</p></td>
<td><p><code>LAX</code></p></td>
<td><p>When using cookie, used to set the
SameSite cookie value. Can be "Strict" or "Lax".</p></td>
</tr>
<tr>
<td><p><code>cookie-secure</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>When using cookie, if set to true, the
Secure attribute will be configured. Defaults to false.</p></td>
</tr>
<tr>
<td><p><code>cookie-use</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether to use cookie to store JWT
between requests. Defaults to DEFAULT_COOKIE_USE.</p></td>
</tr>
<tr>
<td><p><code>cors</code></p></td>
<td><p><a href="../config/io_helidon_cors_CrossOriginConfig.md">CrossOriginConfig</a></p></td>
<td></td>
<td><p>Assign cross-origin resource sharing
settings.</p></td>
</tr>
<tr>
<td><p><code>force-https-redirects</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>Force HTTPS for redirects to identity
provider. Defaults to <code>false</code>.</p></td>
</tr>
<tr>
<td><p><code>frontend-uri</code></p></td>
<td><p>string</p></td>
<td></td>
<td><p>Full URI of this application that is
visible from user browser. Used to redirect request back from identity
server after successful login.</p></td>
</tr>
<tr>
<td><p><code>header-token</code></p></td>
<td><p><a href="../config/io_helidon_security_util_TokenHandler.md">TokenHandler</a></p></td>
<td></td>
<td><p>A TokenHandler to process header
containing a JWT. Default is "Authorization" header with a prefix
"bearer ".</p></td>
</tr>
<tr>
<td><p><code>header-use</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether to expect JWT in a header
field.</p></td>
</tr>
<tr>
<td><p><code>id-token-signature-validation</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether id token signature check should
be enabled. Signature check is enabled by default, and it is highly
recommended to not change that. Change this setting only when you really
know what you are doing, otherwise it could case security
issues.</p></td>
</tr>
<tr>
<td><p><code>identity-uri</code></p></td>
<td><p>URI</p></td>
<td></td>
<td><p>URI of the identity server, base used
to retrieve OIDC metadata.</p></td>
</tr>
<tr>
<td><p><code>introspect-endpoint-uri</code></p></td>
<td><p>URI</p></td>
<td></td>
<td><p>Endpoint to use to validate JWT. Either
use this or set signJwk(JwkKeys) or signJwk(Resource).</p></td>
</tr>
<tr>
<td><p><code>issuer</code></p></td>
<td><p>string</p></td>
<td></td>
<td><p>Issuer of issued tokens.</p></td>
</tr>
<tr>
<td><p><code>max-redirects</code></p></td>
<td><p>int</p></td>
<td><p><code>5</code></p></td>
<td><p>Configure maximal number of redirects
when redirecting to an OIDC provider within a single authentication
attempt.</p>
<p>Defaults to DEFAULT_MAX_REDIRECTS</p></td>
</tr>
<tr>
<td><p><code>oidc-metadata-well-known</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>If set to true, metadata will be loaded
from default (well known) location, unless it is explicitly defined
using oidc-metadata-resource. If set to false, it would not be loaded
even if oidc-metadata-resource is not defined. In such a case all URIs
must be explicitly defined (e.g. token-endpoint-uri).</p></td>
</tr>
<tr>
<td><p><code>oidc-metadata.resource</code></p></td>
<td><p><a href="../config/io_helidon_common_configurable_Resource.md">Resource</a></p></td>
<td></td>
<td><p>Resource configuration for OIDC
Metadata containing endpoints to various identity services, as well as
information about the identity server.</p></td>
</tr>
<tr>
<td><p><code>optional</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>Whether authentication is required. By
default, request will fail if the authentication cannot be verified. If
set to true, request will process and this provider will
abstain.</p></td>
</tr>
<tr>
<td><p><code>optional-audience</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>Allow audience claim to be
optional.</p></td>
</tr>
<tr>
<td><p><code>outbound</code></p></td>
<td><p><a href="../config/io_helidon_security_providers_common_OutboundTarget.md">OutboundTarget[]</a></p></td>
<td></td>
<td><p>Add a new target
configuration.</p></td>
</tr>
<tr>
<td><p><code>pkce-challenge-method</code></p></td>
<td><p>PkceChallengeMethod (PLAIN,
S256)</p></td>
<td><p><code>S256</code></p></td>
<td><p>Proof Key Code Exchange (PKCE)
challenge creation method. Default value is
PkceChallengeMethod.S256.</p>
<p>Allowed values:</p>
<ul>
<li><p><code>PLAIN</code>: No hashing will be applied. Challenge string
will be the same as verifier.</p></li>
<li><p><code>S256</code>: SHA-256 algorithm is used to hash the verifier
value.</p></li>
</ul></td>
</tr>
<tr>
<td><p><code>pkce-enabled</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>Whether this provider should support
PKCE. Default value is <code>false</code>.</p></td>
</tr>
<tr>
<td><p><code>propagate</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>Whether to propagate identity.</p></td>
</tr>
<tr>
<td><p><span class="line-through"><code>proxy-host</code></span></p></td>
<td><p>string</p></td>
<td></td>
<td><p><strong>Deprecated</strong> Proxy host
to use. When defined, triggers usage of proxy for HTTP requests. Setting
to empty String has the same meaning as setting to null - disables
proxy.</p></td>
</tr>
<tr>
<td><p><code>proxy-port</code></p></td>
<td><p>int</p></td>
<td><p><code>80</code></p></td>
<td><p>Proxy port. Defaults to
DEFAULT_PROXY_PORT</p></td>
</tr>
<tr>
<td><p><span class="line-through"><code>proxy-protocol</code></span></p></td>
<td><p>string</p></td>
<td><p><code>http</code></p></td>
<td><p><strong>Deprecated</strong> Proxy
protocol to use when proxy is used. Defaults to
DEFAULT_PROXY_PROTOCOL.</p></td>
</tr>
<tr>
<td><p><code>query-id-token-param-name</code></p></td>
<td><p>string</p></td>
<td><p><code>id_token</code></p></td>
<td><p>Name of a query parameter that contains
the JWT id token when parameter is used.</p></td>
</tr>
<tr>
<td><p><code>query-param-name</code></p></td>
<td><p>string</p></td>
<td><p><code>accessToken</code></p></td>
<td><p>Name of a query parameter that contains
the JWT access token when parameter is used.</p></td>
</tr>
<tr>
<td><p><code>query-param-tenant-name</code></p></td>
<td><p>string</p></td>
<td><p><code>h_tenant</code></p></td>
<td><p>Name of a query parameter that contains
the tenant name when the parameter is used. Defaults to
DEFAULT_TENANT_PARAM_NAME.</p></td>
</tr>
<tr>
<td><p><code>query-param-use</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>Whether to use a query parameter to
send JWT token from application to this server.</p></td>
</tr>
<tr>
<td><p><code>redirect</code></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p>By default, the client should redirect
to the identity server for the user to log in. This behavior can be
overridden by setting redirect to false. When token is not present in
the request, the client will not redirect and just return appropriate
error response code.</p></td>
</tr>
<tr>
<td><p><code>redirect-attempt-param</code></p></td>
<td><p>string</p></td>
<td><p><code>h_ra</code></p></td>
<td><p>Configure the parameter used to store
the number of attempts in redirect.</p>
<p>Defaults to DEFAULT_ATTEMPT_PARAM</p></td>
</tr>
<tr>
<td><p><code>redirect-uri</code></p></td>
<td><p>string</p></td>
<td><p><code>/oidc/redirect</code></p></td>
<td><p>URI to register web server component
on, used by the OIDC server to redirect authorization requests to after
a user logs in or approves scopes. Note that usually the redirect URI
configured here must be the same one as configured on OIDC server.</p>
<p>Defaults to DEFAULT_REDIRECT_URI</p></td>
</tr>
<tr>
<td><p><span class="line-through"><code>relative-uris</code></span></p></td>
<td><p>boolean</p></td>
<td><p><code>false</code></p></td>
<td><p><strong>Deprecated</strong> Can be set
to <code>true</code> to force the use of relative URIs in all requests,
regardless of the presence or absence of proxies or no-proxy lists. By
default, requests that use the Proxy will have absolute URIs. Set this
flag to <code>true</code> if the host is unable to accept absolute URIs.
Defaults to DEFAULT_RELATIVE_URIS.</p></td>
</tr>
<tr>
<td><p><code>scope-audience</code></p></td>
<td><p>string</p></td>
<td></td>
<td><p>Audience of the scope required by this
application. This is prefixed to the scope name when requesting scopes
from the identity server. Defaults to empty string.</p></td>
</tr>
<tr>
<td><p><code>server-type</code></p></td>
<td><p>string</p></td>
<td><p><code>@default</code></p></td>
<td><p>Configure one of the supported types of
identity servers.</p>
<p>If the type does not have an explicit mapping, a warning is logged
and the default implementation is used.</p></td>
</tr>
<tr>
<td><p><code>sign-jwk.resource</code></p></td>
<td><p><a href="../config/io_helidon_common_configurable_Resource.md">Resource</a></p></td>
<td></td>
<td><p>A resource pointing to JWK with public
keys of signing certificates used to validate JWT.</p></td>
</tr>
<tr>
<td><p><code>tenants</code></p></td>
<td><p><a href="../config/io_helidon_security_providers_oidc_common_TenantConfig.md">TenantConfig</a></p></td>
<td></td>
<td><p>Configurations of the tenants</p></td>
</tr>
<tr>
<td><p><code>token-endpoint-auth</code></p></td>
<td><p>ClientAuthentication
(CLIENT_SECRET_BASIC, CLIENT_SECRET_POST, CLIENT_SECRET_JWT,
PRIVATE_KEY_JWT, CLIENT_CERTIFICATE, NONE)</p></td>
<td><p><code>CLIENT_SECRET_BASIC</code></p></td>
<td><p>Type of authentication to use when
invoking the token endpoint. Current supported options:</p>
<ul>
<li><p>io.helidon.security.providers.oidc.common.OidcConfig.ClientAuthentication.CLIENT_SECRET_BASIC</p></li>
<li><p>io.helidon.security.providers.oidc.common.OidcConfig.ClientAuthentication.CLIENT_SECRET_POST</p></li>
<li><p>io.helidon.security.providers.oidc.common.OidcConfig.ClientAuthentication.NONE</p></li>
</ul>
<p>Allowed values:</p>
<ul>
<li><p><code>CLIENT_SECRET_BASIC</code>: Clients that have received a
client_secret value from the Authorization Server authenticate with the
Authorization Server in accordance with Section 2.3.1 of OAuth 2.0
[RFC6749] using the HTTP Basic authentication scheme. This is the
default client authentication.</p></li>
<li><p><code>CLIENT_SECRET_POST</code>: Clients that have received a
client_secret value from the Authorization Server, authenticate with the
Authorization Server in accordance with Section 2.3.1 of OAuth 2.0
[RFC6749] by including the Client Credentials in the request
body.</p></li>
<li><p><code>CLIENT_SECRET_JWT</code>: Clients that have received a
client_secret value from the Authorization Server create a JWT using an
HMAC SHA algorithm, such as HMAC SHA-256. The HMAC (Hash-based Message
Authentication Code) is calculated using the octets of the UTF-8
representation of the client_secret as the shared key. The Client
authenticates in accordance with JSON Web Token (JWT) Profile for OAuth
2.0 Client Authentication and Authorization Grants [OAuth.JWT] and
Assertion Framework for OAuth 2.0 Client Authentication and
Authorization Grants [OAuth.Assertions].</p></li>
</ul>
<p>The JWT MUST contain the following REQUIRED Claim Values and MAY
contain the following OPTIONAL Claim Values.</p>
<p>Required: <code>iss, sub, aud, jti, exp</code></p>
<p>Optional: <code>iat</code> - <code>PRIVATE_KEY_JWT</code>: Clients
that have registered a public key sign a JWT using that key. The Client
authenticates in accordance with JSON Web Token (JWT) Profile for OAuth
2.0 Client Authentication and Authorization Grants [OAuth.JWT] and
Assertion Framework for OAuth 2.0 Client Authentication and
Authorization Grants [OAuth.Assertions].</p>
<p>The JWT MUST contain the following REQUIRED Claim Values and MAY
contain the following OPTIONAL Claim Values.</p>
<p>Required: <code>iss, sub, aud, jti, exp</code></p>
<p>Optional: <code>iat</code> - <code>CLIENT_CERTIFICATE</code>:
Authentication is done via the client certificate used with MTLS. The
Returned access token is bound to this client certificate. The Client
needs to have MTLS enabled for the OIDC. - <code>NONE</code>: The Client
does not authenticate itself at the Token Endpoint, either because it
uses only the Implicit Flow (and so does not use the Token Endpoint) or
because it is a Public Client with no Client Secret or other
authentication mechanism.</p></td>
</tr>
<tr>
<td><p><code>token-endpoint-uri</code></p></td>
<td><p>URI</p></td>
<td></td>
<td><p>URI of a token endpoint used to obtain
a JWT based on the authentication code. If not defined, it is obtained
from oidcMetadata(Resource), if that is not defined an attempt is made
to use identityUri(URI)/oauth2/v1/token.</p></td>
</tr>
<tr>
<td><p><code>token-signature-validation</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Whether access token signature check
should be enabled. Signature check is enabled by default, and it is
highly recommended to not change that. Change this setting only when you
really know what you are doing, otherwise it could case security
issues.</p></td>
</tr>
<tr>
<td><p><code>use-jwt-groups</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Claim <code>groups</code> from JWT will
be used to automatically add groups to current subject (may be used with
jakarta.annotation.security.RolesAllowed annotation).</p></td>
</tr>
<tr>
<td><p><code>validate-jwt-with-jwk</code></p></td>
<td><p>boolean</p></td>
<td><p><code>true</code></p></td>
<td><p>Use JWK (a set of keys to validate
signatures of JWT) to validate tokens. Use this method when you want to
use default values for JWK or introspection endpoint URI.</p></td>
</tr>
<tr>
<td><p><code>webclient</code></p></td>
<td><p><a href="../config/io_helidon_webclient_api_WebClient.md">WebClient</a></p></td>
<td></td>
<td><p>WebClient configuration used for
outbound requests to the identity server. This configuration sets the
values to the OIDC WebClient default configuration.</p></td>
</tr>
</tbody>
</table>
